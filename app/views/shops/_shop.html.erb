<div class="card bg-primary/10 mx-auto w-full my-6 shadow-xl">
  <div class="card-body p-6">
    <% if current_user %>
      <div class="fav-button text-lg text-right h-auto">
        <%= render 'fav_buttons', shop: shop %>
      </div>
    <% end %>

    <div class="area text-xs text-right">
      <%= shop.area.name %>
    </div>

    <h2 class="card-title text-lg">
      <%= shop.name %>
    </h2>

    <div class="tags">
      <% shop.tags.each do |tag| %>
        <div class="badge badge-accent badge-sm">
          <%= tag.name %>
        </div>
      <% end %>
      <%= link_to t('defaults.edit_tags'), shop_tags_path(shop), class: 'inline-block link link-accent text-xs', data: { turbo: false } %>
    </div>

    <div class="rating-averages">
      <div class="indicator w-full">
        <span class="indicator-item indicator-bottom indicator-center badge badge-secondary badge-sm rounded"><%= t('defaults.preferences_rating') %></span>
        <div class="flex flex-col w-full mx-2 gap-y-4 mt-4 px-2 pt-2 pb-6 bg-base-100/50 border border-secondary border-dotted rounded-lg">
          <%= render 'rating_for_show', shop: shop, field: :int_average, description: t("defaults.description.int_average") %>
          <%= render 'rating_for_show', shop: shop, field: :eqcust_average, description: t("defaults.description.eqcust_average") %>
          <%= render 'rating_for_show', shop: shop, field: :sofr_average, description: t("defaults.description.sofr_average") %>
        </div>
      </div>
    </div>

    <div id="map" class="h-[350px] md:h-[600px] mt-6"></div>
    <script>
      function initMap() {
        // 地図要素を取得する（マーカーを表示させるために必要）
        const mapElement = document.getElementById('map');

        const mapOptions = {
          center: { lat: <%= shop.latitude %>, lng: <%= shop.longitude %> },
          zoom: 14
        };

        const map = new google.maps.Map(mapElement, mapOptions);

        // マーカーを追加
        const marker = new google.maps.Marker({
          position: {lat: <%= shop.latitude %>, lng: <%= shop.longitude %>},
          map: map,
          title: '<%= shop.name %>',
          clickable: false
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV["GOOGLE_API_KEY"] %>&callback=initMap"></script>

    <div class="static-informations mx-auto space-y-4 px-2 mt-6">

      <div class="attribute grid grid-cols-[1fr_8fr]">
        <div>
          <i class="fa-solid fa-location-dot"></i>
        </div>
        <div>
          <%= simple_format(shop.address) %>
        </div>
      </div>

      <div class="attribute grid grid-cols-[1fr_8fr]">
        <div>
          <i class="fa-solid fa-phone"></i>
        </div>
        <div>
          <%= link_to shop.phone_number, "tel:#{shop.phone_number}", class: 'link md:pointer-events-none md:no-underline' %>
        </div>
      </div>

      <div class="attribute grid grid-cols-[1fr_8fr]">
        <div>
          <i class="fa-solid fa-clock"></i>
        </div>
        <div>
          <%= simple_format(shop.opening_hours) %>
        </div>
      </div>
    </div>

    <%= render 'shop_buttons', shop: shop %>
  </div>
</div>